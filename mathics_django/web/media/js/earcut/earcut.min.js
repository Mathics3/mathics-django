function earcut(e,n,r){r=r||2;var t,i,x,o,a,u,l,s=n&&n.length,v=s?n[0]*r:e.length,f=linkedList(e,0,v,r,!0),y=[];if(!f||f.next===f.prev)return y;if(s&&(f=eliminateHoles(e,n,f,r)),e.length>80*r){t=x=e[0],i=o=e[1];for(var p=r;p<v;p+=r)(a=e[p])<t&&(t=a),(u=e[p+1])<i&&(i=u),x<a&&(x=a),o<u&&(o=u);l=0!==(l=Math.max(x-t,o-i))?1/l:0}return earcutLinked(f,y,r,t,i,l),y}function linkedList(e,n,r,t,i){var x,o;if(i===0<signedArea(e,n,r,t))for(x=n;x<r;x+=t)o=insertNode(x,e[x],e[x+1],o);else for(x=r-t;n<=x;x-=t)o=insertNode(x,e[x],e[x+1],o);return o&&equals(o,o.next)&&(removeNode(o),o=o.next),o}function filterPoints(e,n){if(!e)return e;n=n||e;var r,t=e;do{if(r=!1,t.steiner||!equals(t,t.next)&&0!==area(t.prev,t,t.next))t=t.next;else{if(removeNode(t),(t=n=t.prev)===t.next)break;r=!0}}while(r||t!==n);return n}function earcutLinked(e,n,r,t,i,x,o){if(e){!o&&x&&indexCurve(e,t,i,x);for(var a,u,l=e;e.prev!==e.next;)if(a=e.prev,u=e.next,x?isEarHashed(e,t,i,x):isEar(e))n.push(a.i/r),n.push(e.i/r),n.push(u.i/r),removeNode(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?earcutLinked(e=cureLocalIntersections(filterPoints(e),n,r),n,r,t,i,x,2):2===o&&splitEarcut(e,n,r,t,i,x):earcutLinked(filterPoints(e),n,r,t,i,x,1);break}}}function isEar(e){var n=e.prev,r=e,t=e.next;if(0<=area(n,r,t))return!1;for(var i=e.next.next;i!==e.prev;){if(pointInTriangle(n.x,n.y,r.x,r.y,t.x,t.y,i.x,i.y)&&0<=area(i.prev,i,i.next))return!1;i=i.next}return!0}function isEarHashed(e,n,r,t){var i=e.prev,x=e,o=e.next;if(0<=area(i,x,o))return!1;for(var a=(i.x<x.x?i.x<o.x?i:o:x.x<o.x?x:o).x,u=(i.y<x.y?i.y<o.y?i:o:x.y<o.y?x:o).y,l=(i.x>x.x?i.x>o.x?i:o:x.x>o.x?x:o).x,s=(i.y>x.y?i.y>o.y?i:o:x.y>o.y?x:o).y,v=zOrder(a,u,n,r,t),f=zOrder(l,s,n,r,t),y=e.prevZ,p=e.nextZ;y&&y.z>=v&&p&&p.z<=f;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,y.x,y.y)&&0<=area(y.prev,y,y.next))return!1;if(y=y.prevZ,p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.nextZ}for(;y&&y.z>=v;){if(y!==e.prev&&y!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,y.x,y.y)&&0<=area(y.prev,y,y.next))return!1;y=y.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&pointInTriangle(i.x,i.y,x.x,x.y,o.x,o.y,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.nextZ}return!0}function cureLocalIntersections(e,n,r){var t=e;do{var i=t.prev,x=t.next.next}while(!equals(i,x)&&intersects(i,t,t.next,x)&&locallyInside(i,x)&&locallyInside(x,i)&&(n.push(i.i/r),n.push(t.i/r),n.push(x.i/r),removeNode(t),removeNode(t.next),t=e=x),(t=t.next)!==e);return filterPoints(t)}function splitEarcut(e,n,r,t,i,x){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&isValidDiagonal(o,a)){var u=splitPolygon(o,a),o=filterPoints(o,o.next),u=filterPoints(u,u.next);return earcutLinked(o,n,r,t,i,x),void earcutLinked(u,n,r,t,i,x)}a=a.next}}while((o=o.next)!==e)}function eliminateHoles(e,n,r,t){for(var i,x=[],o=0,a=n.length;o<a;o++)(i=linkedList(e,n[o]*t,o<a-1?n[o+1]*t:e.length,t,!1))===i.next&&(i.steiner=!0),x.push(getLeftmost(i));for(x.sort(compareX),o=0;o<x.length;o++)eliminateHole(x[o],r),r=filterPoints(r,r.next);return r}function compareX(e,n){return e.x-n.x}function eliminateHole(e,n){(n=findHoleBridge(e,n))&&(e=splitPolygon(n,e),filterPoints(n,n.next),filterPoints(e,e.next))}function findHoleBridge(e,n){var r,t=n,i=e.x,x=e.y,o=-1/0;do{if(x<=t.y&&x>=t.next.y&&t.next.y!==t.y){var a=t.x+(x-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(a<=i&&o<a){if((o=a)===i){if(x===t.y)return t;if(x===t.next.y)return t.next}r=t.x<t.next.x?t:t.next}}}while((t=t.next)!==n);if(!r)return null;if(i===o)return r;for(var u,l=r,s=r.x,v=r.y,f=1/0,t=r;i>=t.x&&t.x>=s&&i!==t.x&&pointInTriangle(x<v?i:o,x,s,v,x<v?o:i,x,t.x,t.y)&&(u=Math.abs(x-t.y)/(i-t.x),locallyInside(t,e)&&(u<f||u===f&&(t.x>r.x||t.x===r.x&&sectorContainsSector(r,t)))&&(r=t,f=u)),t=t.next,t!==l;);return r}function sectorContainsSector(e,n){return area(e.prev,e,n.prev)<0&&area(n.next,e,e.next)<0}function indexCurve(e,n,r,t){for(var i=e;null===i.z&&(i.z=zOrder(i.x,i.y,n,r,t)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==e;);i.prevZ.nextZ=null,i.prevZ=null,sortLinked(i)}function sortLinked(e){var n,r,t,i,x,o,a,u,l=1;do{for(r=e,x=e=null,o=0;r;){for(o++,t=r,n=a=0;n<l&&(a++,t=t.nextZ);n++);for(u=l;0<a||0<u&&t;)0!==a&&(0===u||!t||r.z<=t.z)?(r=(i=r).nextZ,a--):(t=(i=t).nextZ,u--),x?x.nextZ=i:e=i,i.prevZ=x,x=i;r=t}}while(x.nextZ=null,l*=2,1<o);return e}function zOrder(e,n,r,t,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*i)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function getLeftmost(e){for(var n=e,r=e;(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next,n!==e;);return r}function pointInTriangle(e,n,r,t,i,x,o,a){return 0<=(i-o)*(n-a)-(e-o)*(x-a)&&0<=(e-o)*(t-a)-(r-o)*(n-a)&&0<=(r-o)*(x-a)-(i-o)*(t-a)}function isValidDiagonal(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!intersectsPolygon(e,n)&&(locallyInside(e,n)&&locallyInside(n,e)&&middleInside(e,n)&&(area(e.prev,e,n.prev)||area(e,n.prev,n))||equals(e,n)&&0<area(e.prev,e,e.next)&&0<area(n.prev,n,n.next))}function area(e,n,r){return(n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y)}function equals(e,n){return e.x===n.x&&e.y===n.y}function intersects(e,n,r,t){var i=sign(area(e,n,r)),x=sign(area(e,n,t)),o=sign(area(r,t,e)),a=sign(area(r,t,n));return i!==x&&o!==a||(!(0!==i||!onSegment(e,r,n))||(!(0!==x||!onSegment(e,t,n))||(!(0!==o||!onSegment(r,e,t))||!(0!==a||!onSegment(r,n,t)))))}function onSegment(e,n,r){return n.x<=Math.max(e.x,r.x)&&n.x>=Math.min(e.x,r.x)&&n.y<=Math.max(e.y,r.y)&&n.y>=Math.min(e.y,r.y)}function sign(e){return 0<e?1:e<0?-1:0}function intersectsPolygon(e,n){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==n.i&&r.next.i!==n.i&&intersects(r,r.next,e,n))return!0}while((r=r.next)!==e);return!1}function locallyInside(e,n){return area(e.prev,e,e.next)<0?0<=area(e,n,e.next)&&0<=area(e,e.prev,n):area(e,n,e.prev)<0||area(e,e.next,n)<0}function middleInside(e,n){for(var r=e,t=!1,i=(e.x+n.x)/2,x=(e.y+n.y)/2;r.y>x!=r.next.y>x&&r.next.y!==r.y&&i<(r.next.x-r.x)*(x-r.y)/(r.next.y-r.y)+r.x&&(t=!t),r=r.next,r!==e;);return t}function splitPolygon(e,n){var r=new Node(e.i,e.x,e.y),t=new Node(n.i,n.x,n.y),i=e.next,x=n.prev;return(e.next=n).prev=e,(r.next=i).prev=r,(t.next=r).prev=t,(x.next=t).prev=x,t}function insertNode(e,n,r,t){r=new Node(e,n,r);return t?(r.next=t.next,(r.prev=t).next.prev=r,t.next=r):(r.prev=r).next=r,r}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,n,r){this.i=e,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,n,r,t){for(var i=0,x=n,o=r-t;x<r;x+=t)i+=(e[o]-e[x])*(e[x+1]+e[o+1]),o=x;return i}